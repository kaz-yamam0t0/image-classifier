{"version":3,"file":"main.js","sources":["../src/js/util.ts","../src/js/preview.ts","../src/js/config.ts","../src/js/connection.ts","../src/js/sources.ts","../src/js/main.ts"],"sourcesContent":["\nconst listen = function(name:string, callback) {\n\t(this || window).addEventListener(name, callback);\n};\n\n// debugger\nlet _debug = null;\nconst debug = (s:string)=>{\n\tif (_debug == null) {\n\t\t_debug = createElement(\"div\", {\"class\":\"debugger\"}, document.body);\n\t}\n\t_debug.innerHTML = s;\n};\n\n\n\nconst setAttrs = (el:any, attrs:any)=>{\n\tif (!attrs) {\n\t\treturn;\n\t}\n\tif (typeof attrs === \"string\") {\n\t\tattrs = { \"text\" : attrs };\n\t}\n\tif (attrs) {\n\t\tObject.keys(attrs).forEach((k)=>{\n\t\t\tconst v = attrs[k];\n\t\t\tif (typeof v === \"undefined\" || v === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// style\n\t\t\tif (k == \"style\" && (typeof v === \"object\")) {\n\t\t\t\tObject.keys(v).forEach(k_=>{\n\t\t\t\t\tel.style[k_] = v[k_];\n\t\t\t\t});\n\t\t\t} \n\t\t\t// class\n\t\t\telse if (k == \"class\") {\n\t\t\t\tif (Array.isArray(v)) {\n\t\t\t\t\tv.forEach(v_=>el.classList.add(v_));\n\t\t\t\t} else if (typeof v === \"object\") {\n\t\t\t\t\tObject.keys(v).forEach(k_=>{\n\t\t\t\t\t\tif (v[k_] == true) {\n\t\t\t\t\t\t\tel.classList.add(k_);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tel.classList.remove(k_);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tv.split(/\\s+/).forEach(v_=>{\n\t\t\t\t\t\tif (v_ = v_.trim()) el.classList.add(v_);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} \n\t\t\t// text\n\t\t\telse if (k === \"text\") {\n\t\t\t\tel.textContent = v;\n\t\t\t}\n\t\t\t// default\n\t\t\telse {\n\t\t\t\tel[k] = v\n\t\t\t}\n\t\t});\t\n\t}\n};\nconst setStyle = (el:any, styles:Object)=>{\n\tsetAttrs(el, { \"style\": styles });\n};\nconst createElement = (tagName:string, attrs:any, parentNode:any=null, callback:any=null)=>{\n\tconst el = document.createElement(tagName);\n\tif (attrs) setAttrs(el, attrs);\n\n\tif (parentNode) {\n\t\tparentNode.appendChild(el)\n\t}\n\tif (callback) {\n\t\tcallback(el);\n\t}\n\treturn el;\n};\n\nconst find = (q:string, el:any=null)=>{\n\treturn (el || document).querySelector(q);\n};\nconst findByClass = (q:string, el:any=null)=>{\n\tconst elements = (el || document).getElementsByClassName(q);\n\tif (elements.length > 0) return elements[0];\n\treturn null;\n};\n\n\nexport {\n\tlisten,\n\tdebug,\n\tcreateElement, \n\tsetAttrs,\n\tsetStyle, \n\n\tfind,\n\tfindByClass,\n}","\n\nimport { listen, debug, setStyle, createElement, findByClass } from './util';\n\nclass Preview {\n\tmode = 0; // 1=moving 2=point\n\n\t// event position\n\tstartX = 0;\n\tstartY = 0;\n\tpageX = 0;\n\tpageY = 0;\n\t\n\t// image position\n\t_imageStartX = 0;\n\t_imageStartY = 0;\n\timageX = 0;\n\timageY = 0;\n\n\t// frame position\n\t_frameStartX = 0;\n\t_frameStartY = 0;\n\t_frameStartW = 0;\n\t_frameStartH = 0;\n\tframeX = 0;\n\tframeY = 0;\n\tframeWidth = 0;\n\tframeHeight = 0;\n\n\t// zoom\n\tzoom = 1;\n\n\t// image data\n\timageUrl: string;\n\timage = null; // Image\n\n\t// elements\n\tel = null; // div.preview\n\tbg = null;            // div.bg\n\tframe = null;         // div.frame\n\tframeImage = null;    // div.frame div.image\n\tframeDragger = null;  // div.frame div.dragger\n\tframePoints = [];     // [ div.point ]\n\n\t// event callbacks\n\t__mousedown = null;\n\t__mousemove = null;\n\t__mouseup = null;\n\n\t__point_mousedown = null;\n\t__point_mousemove = null;\n\t__point_mouseup = null;\n\n\t// options\n\toptions = null;\n\n\t// Sources\n\t//sources = null;\n\tdata = null;\n\n\tconstructor(image_data, options=null) {\n\t\t//this.sources = sources;\n\t\tthis.data = image_data;\n\t\tthis.imageUrl = image_data.path;\n\t\tthis.options = options;\n\t\tthis.reset();\n\t}\n\treset() {\n\t\tthis.mode = 0;\n\t\tthis.startX = this.startY = 0;\n\t\tthis.pageX = this.pageY = 0;\n\t\tthis.imageX = this.imageY = 0;\n\t\tthis._imageStartX = this._imageStartY = 0;\n\n\t\tthis._frameStartX = this._frameStartY = 0;\n\t\tthis._frameStartW = this._frameStartH = 0;\n\t\tthis.frameX = this.frameY = 0;\n\t\tthis.frameWidth = this.frameHeight = 0;\n\n\t\tthis.zoom = 1;\n\n\t\t//this.image = null;\n\t\t//this.el = null;\n\t}\n\n\tfree() {\n\t\tconst self = this;\n\n\t\t// free events\n\t\t//if (this.__mousedown) this.el.removeEventListener(\"mousedown\", this.__mousedown);\n\t\t//if (this.__mousemove) this.el.removeEventListener(\"mousemove\", this.__mousemove);\n\t\t//if (this.__mouseup) this.el.removeEventListener(\"mouseup\", this.__mouseup);\n\t\t\n\t\t//if (this.__mousedown) this.frame.removeEventListener(\"mousedown\", this.__mousedown);\n\t\t//if (this.__mousemove) this.frame.removeEventListener(\"mousemove\", this.__mousemove);\n\t\t//if (this.__mouseup) this.frame.removeEventListener(\"mouseup\", this.__mouseup);\n\n\t\tthis.framePoints.forEach(p=>{\n\t\t\tif (self.__point_mousedown) p.removeEventListener(\"mousedown\", self.__point_mousedown);\n\t\t\t//if (self.__point_mousemove) p.removeEventListener(\"mousemove\", self.__point_mousemove);\n\t\t\t//if (self.__point_mouseup) p.removeEventListener(\"mouseup\", self.__point_mouseup);\n\t\t\t//if (self.__point_mouseup) p.removeEventListener(\"mouseleave\", self.__point_mouseup);\n\t\t});\n\t\tif (self.__point_mousemove) this.frame.removeEventListener(\"mousemove\", self.__point_mousemove);\n\t\tif (self.__point_mouseup) this.frame.removeEventListener(\"mouseup\", self.__point_mouseup);\n\t\tif (self.__point_mouseup) this.frame.removeEventListener(\"mouseleave\", self.__point_mouseup);\n\n\t\t// remove elements\n\t\tthis.framePoints.forEach(p=>p.remove());\n\t\tthis.framePoints = [];\n\n\t\tif (this.frameDragger) this.frameDragger.remove();\n\t\tif (this.frameImage) this.frameImage.remove();\n\t\tif (this.frame) this.frame.remove();\n\t\tif (this.bg) this.bg.remove();\n\n\t\t// alter elements and events to NULL\n\t\tthis.__mousedown = null;\n\t\tthis.__mousemove = null;\n\t\tthis.__mouseup = null;\n\n\t\tthis.__point_mousedown = null;\n\t\tthis.__point_mousemove = null;\n\t\tthis.__point_mouseup = null;\n\n\t\tthis.el = null;\n\t\tthis.image = null;\n\t\tthis.bg = null;\n\t\tthis.frame = null;\n\t\tthis.frameImage = null;\n\t\tthis.frameDragger = null;\n\n\t\t//this.sources = null;\n\t\tthis.data = null;\n\t}\n\n\tmount() {\n\t\tif (!(this.el = findByClass(\"preview\"))) {\n\t\t\tthrow 'preview not found.';\t\t\t\n\t\t}\n\t\tthis.image = new Image();\n\t\tthis.image.src = this.imageUrl;\n\n\t\tif (this.image.complete) {\n\t\t\tthis.onload();\n\t\t} else {\n\t\t\tconst self = this;\n\t\t\tthis.image.onload = ()=>{\n\t\t\t\tself.onload();\n\t\t\t};\n\t\t\tthis.image.onerror = (err)=>{\n\t\t\t\t// @TODO\n\t\t\t};\n\t\t}\n\t}\n\tonload() {\n\t\tconst self = this;\n\n\t\t//this.bg = createElement(\"img\", {\n\t\t//\t\"src\" : this.imageUrl,\n\t\t//\t\"class\" : \"bg\",\n\t\t//}, this.el);\n\t\tthis.bg = createElement(\"div\", {\"class\" : \"bg\"}, this.el);\n\t\tcreateElement(\"img\", { \"src\" : this.imageUrl }, this.bg);\n\n\t\tthis.frame = createElement(\"div\", {\"class\": \"frame\"}, this.el);\n\t\t\n\t\tthis.frameDragger = createElement(\"div\", {\"class\": \"dragger\"} , this.frame);\n\t\t//this.frameImage = createElement(\"img\", {\n\t\t//\t\"src\" : this.imageUrl,\n\t\t//}, this.frame);\n\t\tthis.frameImage = createElement(\"div\", {\"class\":\"image\"}, this.frame);\n\t\tcreateElement(\"img\", { \"src\": this.imageUrl } , this.frameImage);\n\n\t\t[\"ne\",\"nw\",\"sw\",\"se\"].forEach((dir)=>{\n\t\t\tconst el = createElement(\"div\", {\"class\" : ['point',`-${dir}`] }, self.frame);\n\t\t\tself.framePoints.push(el);\n\t\t});\n\n\t\t// calculate ratio\n\t\tlet w0 = this.el.clientWidth, \n\t\t\th0 = this.el.clientHeight, \n\t\t\tw = this.image.width, \n\t\t\th = this.image.height;\n\t\t\n\t\tlet r = 1;\n\t\t// zoom == 1\n\t\t/*\n\t\tif (w > w0) {\n\t\t\tr = Math.min(r, w0 / w);\n\t\t\tw *= r; h *= r;\n\t\t}\n\t\tif (h > h0) {\n\t\t\tr = Math.min(r, h0 / h);\n\t\t\tw *= r; h *= r;\n\t\t}\n\t\t*/\n\n\t\t// initialize image size and position\n\t\tthis.zoom = r;\n\t\tthis.imageX = (w0 - this.image.width * r) / 2;\n\t\tthis.imageY = (h0 - this.image.height * r) / 2;\n\t\t\n\t\t// calculate frame position\n\t\tthis.frameWidth = this.image.width; // * r;\n\t\tthis.frameHeight = this.image.height; // * r;\n\t\tthis.frameX = this.imageX;\n\t\tthis.frameY = this.imageY;\n\t\t\n\t\tif (this.data && this.data.frame) {\n\t\t\t// maintain frame size\n\t\t\tthis.frameWidth = this.data.frame.width;\n\t\t\tthis.frameHeight = this.data.frame.height;\n\t\t\tthis.frameX = this.imageX + this.data.frame.x;\n\t\t\tthis.frameY = this.imageY + this.data.frame.y;\n\t\t} else {\n\t\t\t// adjust \n\t\t\t// adjust ratio\n\t\t\tif (this.options && this.options.image_size) {\n\t\t\t\tlet [_w_, _h_] = this.options.image_size;\n\t\t\t\tif (_w_ > 0 && _h_ > 0) {\n\t\t\t\t\tconst r_ = _w_ / _h_;\n\t\t\t\t\tlet [w, h] = [this.frameWidth, this.frameHeight];\n\t\t\t\t\t_w_ = h * r_;\n\t\t\t\t\t_h_ = w / r_;\n\t\t\t\t\tif (w > _w_) {\n\t\t\t\t\t\tw = _w_;\n\t\t\t\t\t} else if (h > _h_) {\n\t\t\t\t\t\th = _h_;\n\t\t\t\t\t}\n\t\t\t\t\tthis.frameWidth = w;\n\t\t\t\t\tthis.frameHeight = h;\n\t\t\t\t\tthis.frameX = this.imageX + (this.image.width - w) / 2;\n\t\t\t\t\tthis.frameY = this.imageY + (this.image.width - h) / 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// save data\n\t\tif (this.data) {\n\t\t\tthis.data.frame = {\n\t\t\t\tx: this.frameX - this.imageX, \n\t\t\t\ty: this.frameY - this.imageY,\n\t\t\t\twidth: this.frameWidth, \n\t\t\t\theight: this.frameHeight,\n\t\t\t};\n\t\t}\n\n\t\t// update \n\t\tthis.update();\n\n\t\t// init events\n\t\tthis.initEvents();\n\t}\n\tupdate() {\n\t\tif (this.bg) {\n\t\t\tsetStyle(this.bg, {\n\t\t\t\t\"left\" : `${this.imageX}px`,\n\t\t\t\t\"top\" : `${this.imageY}px`,\n\t\t\t\t//\"width\" : `${this.image.width * this.zoom}px`,\n\t\t\t\t//\"height\" : `${this.image.height * this.zoom}px`,\n\t\t\t\t\"width\" : `${this.image.width}px`,\n\t\t\t\t\"height\" : `${this.image.height}px`,\n\t\t\t\t\"transform\" : `scale(${this.zoom})`,\n\t\t\t\t\"transform-origin\" : \"center center\",\n\t\t\t});\n\t\t}\n\t\tif (this.frame) {\n\t\t\tsetStyle(this.frame, {\n\t\t\t\t\"left\" : `${this.frameX}px`,\n\t\t\t\t\"top\" : `${this.frameY}px`,\n\t\t\t//\t\"width\" : `${this.frameWidth * this.zoom}px`,\n\t\t\t//\t\"height\" : `${this.frameHeight * this.zoom}px`,\n\t\t\t\t\"width\" : `${this.frameWidth}px`,\n\t\t\t\t\"height\" : `${this.frameHeight}px`,\n\t\t\t\t\"transform\" : `scale(${this.zoom})`,\n\t\t\t\t\"transform-origin\" : \"center center\",\n\t\t\t});\n\t\t}\n\t\tif (this.bg && this.frame && this.frameImage) {\n\t\t\tconst x = this.imageX - this.frameX;\n\t\t\tconst y = this.imageY - this.frameY;\n\n\t\t\tsetStyle(this.frameImage, {\n\t\t\t\t\"left\" : `${x}px`,\n\t\t\t\t\"top\" : `${y}px`,\n\t\t\t//\t\"width\" : `${this.image.width * this.zoom}px`,\n\t\t\t//\t\"height\" : `${this.image.height * this.zoom}px`,\n\t\t\t\t\"width\" : `${this.image.width}px`,\n\t\t\t\t\"height\" : `${this.image.height}px`,\n\t\t\t\t\"transform\" : `scale(${this.zoom})`,\n\t\t\t\t\"transform-origin\" : \"center center\",\n\t\t\t});\n\t\t}\n\t}\n\n\t// event\n\tinitEvents() {\n\t\tconst self = this;\n\t\t/*\n\t\tthis.__mousedown = (e)=>{\n\t\t\tself.mousedown(e);\n\t\t\treturn false;\n\t\t};\n\t\tthis.__mousemove = (e)=>{\n\t\t\tself.mousemove(e);\n\t\t\treturn false;\n\t\t};\n\t\tthis.__mouseup = (e)=>{\n\t\t\tself.mouseup(e);\n\t\t\treturn false;\n\t\t};\n\n\t\t//listen.call(this.frame, \"mousedown\", this.__mousedown);\n\t\t//listen.call(this.frame, \"mousemove\", this.__mousemove);\n\t\t//listen.call(this.frame, \"mouseup\", this.__mouseup);\n\t\t\n\t\t//listen.call(this.el, \"mousedown\", this.__mousedown);\n\t\t//listen.call(this.el, \"mousemove\", this.__mousemove);\n\t\t//listen.call(this.el, \"mouseup\", this.__mouseup);\n\t\t*/\n\t\tthis.__mousedown = (e)=>{\n\t\t\tself.dragMousedown(e);\n\t\t\t//return false;\n\t\t};\n\t\tthis.__mousemove = (e)=>{\n\t\t\tif (self.mode != 1) return;\n\t\t\tself.dragMousemove(e);\n\t\t\t//return false;\n\t\t};\n\t\tthis.__mouseup = (e)=>{\n\t\t\tif (self.mode != 1) return;\n\t\t\tself.dragMouseup(e);\n\t\t\t//return false;\n\t\t};\n\t\tlisten.call(this.frameDragger, \"mousedown\", this.__mousedown);\n\t\tlisten.call(this.frameDragger, \"mousemove\", this.__mousemove);\n\t\tlisten.call(this.frameDragger, \"mouseup\", this.__mouseup);\n\n\n\t\tlet p = null;\n\t\t\n\t\tthis.__point_mousedown = function(e) {\n\t\t\tp = this;\n\n\t\t\t//e.preventDefault();\n\t\t\t//e.stopPropagation();\n\t\t\tself.pointMousedown(e, this);\n\t\t\t//return false;\n\t\t};\n\t\tthis.__point_mousemove = function(e) {\n\t\t\tif (self.mode != 2) return;\n\t\t\tif (!p) return;\n\n\t\t\t//e.preventDefault();\n\t\t\t//e.stopPropagation();\n\t\t\t//self.pointMousemove(e, this);\n\t\t\tself.pointMousemove(e, p);\n\t\t\t//return false;\n\t\t};\n\t\tthis.__point_mouseup = function(e) {\n\t\t\tif (self.mode != 2) return;\n\t\t\tif (!p) return;\n\n\t\t\t//e.preventDefault();\n\t\t\t//e.stopPropagation();\n\t\t\t//self.pointMouseup(e, this);\n\t\t\tself.pointMouseup(e, p);\n\t\t\tp = null;\n\t\t\t//return false;\n\t\t};\n\t\tthis.framePoints.forEach(p=>{\n\t\t\tlisten.call(p, \"mousedown\", self.__point_mousedown);\n\t\t\t//listen.call(p, \"mousemove\", self.__point_mousemove);\n\t\t\t//listen.call(p, \"mouseup\", self.__point_mouseup);\n\t\t\t//listen.call(p, \"mouseleave\", self.__point_mouseup);\n\t\t});\n\t\tlisten.call(this.el, \"mousemove\", this.__point_mousemove);\n\t\tlisten.call(this.el, \"mouseup\", this.__point_mouseup);\n\t\tlisten.call(this.el, \"mouseleave\", this.__point_mouseup);\n\t}\n\t/*\n\tmousedown(e) {\n\t\tthis.mode = 1;\n\t\tthis.pageX = this.startX = e.pageX;\n\t\tthis.pageY = this.startY = e.pageY;\n\t\t//[this._imageStartX, this._imageStartY] = [this.imageX, this.imageY];\n\t\t[this._frameStartX, this._frameStartY] = [this.frameX, this.frameY];\n\t\tthis.update();\n\t\tthis._debug();\n\t}\n\tmousemove(e) {\n\t\tif (this.mode != 1) return;\n\n\t\t[this.pageX, this.pageY] = [e.pageX, e.pageY];\n\t\t//this.imageX = this._imageStartX + (this.pageX - this.startX);\n\t\t//this.imageY = this._imageStartY + (this.pageY - this.startY);\n\t\t//this.frameX = this._frameStartX + (this.pageX - this.startX);\n\t\t//this.frameY = this._frameStartY + (this.pageY - this.startY);\n\t\tthis.move(\n\t\t\tthis._frameStartX + (this.pageX - this.startX),\n\t\t\tthis._frameStartY + (this.pageY - this.startY),\n\t\t);\n\t\tthis.update();\n\t\tthis._debug();\n\t}\n\tmouseup(e) {\n\t\tthis.mode = 0;\n\t\tthis.pageX = this.startX = 0;\n\t\tthis.pageY = this.startY = 0;\n\t\tthis._frameStartX = this._frameStartY = 0;\n\t}\n\t*/\n\tmove(x:number, y:number, x2:number=null, y2:number=null) {\n\t\tif (x2 === null) x2 = x + this.frameWidth;\n\t\tif (y2 === null) y2 = y + this.frameHeight;\n\t\tif (x > x2) {\n\t\t\tconst tmp = x;\n\t\t\tx = x2;\n\t\t\tx2 = tmp;\n\t\t}\n\t\tif (y > y2) {\n\t\t\tconst tmp = y;\n\t\t\ty = y2;\n\t\t\ty2 = tmp;\n\t\t}\n\t\tx = Math.max(x, this.imageX);\n\t\ty = Math.max(y, this.imageY);\n\t\tx2 = Math.min(x2, this.imageX + this.image.width);\n\t\ty2 = Math.min(y2, this.imageY + this.image.height);\n\n\t\tthis.frameX = x;\n\t\tthis.frameY = y;\n\n\t\tthis.frameWidth = Math.max(24, x2 - x);\n\t\tthis.frameHeight = Math.max(24, y2 - y);\n\n\t\tif (this.data) {\n\t\t\tthis.data.frame = {\n\t\t\t\tx: x - this.imageX, \n\t\t\t\ty: y - this.imageY,\n\t\t\t\twidth: this.frameWidth, \n\t\t\t\theight: this.frameHeight,\n\t\t\t};\n\t\t}\n\t}\n\tdragMousedown(e) {\n\t\tconsole.log(\"dragMousedown\");\n\t\tthis.mode = 1;\n\t\tthis.pageX = this.startX = e.pageX;\n\t\tthis.pageY = this.startY = e.pageY;\n\t\t//[this._imageStartX, this._imageStartY] = [this.imageX, this.imageY];\n\t\t[this._frameStartX, this._frameStartY] = [this.frameX, this.frameY];\n\t\t[this._frameStartW, this._frameStartH] = [this.frameWidth, this.frameHeight];\n\t\tthis.update();\n\t\tthis._debug();\n\t}\n\tdragMousemove(e) {\n\t\tif (this.mode != 1) return;\n\n\t\tlet [x,y,w,h] = [this._frameStartX, this._frameStartY, this._frameStartW, this._frameStartH];\n\t\tlet [x2,y2] = [x+w, y+h];\n\n\t\t[this.pageX, this.pageY] = [e.pageX, e.pageY];\n\t\tconst dx = (this.pageX - this.startX);// / this.zoom;\n\t\tconst dy = (this.pageY - this.startY);// / this.zoom;\n\t\tx += dx; y += dy;\n\t\tx2 += dx; y2 += dy;\n\t\tif (x < this.imageX) { [x,x2] = [this.imageX,this.imageX+w]; }\n\t\tif (y < this.imageY) { [y,y2] = [this.imageY,this.imageY+h]; }\n\n\t\tif (this.imageX + this.image.width < x2) { \n\t\t\tx2 = this.imageX + this.image.width;\n\t\t\tx = x2 - w;\n\t\t}\n\t\tif (this.imageY + this.image.height < y2) {\n\t\t\ty2 = this.imageY + this.image.height;\n\t\t\ty = y2 - h;\n\t\t}\n\n\t\tthis.move(x,y,x2,y2);\n\t\tthis.update();\n\t\tthis._debug();\n\t}\n\tdragMouseup(e) {\n\t\tif (this.mode != 1) return;\n\n\t\tthis.mode = 0;\n\t\tthis.pageX = this.startX = 0;\n\t\tthis.pageY = this.startY = 0;\n\t\tthis._frameStartX = this._frameStartY = 0;\n\t\tthis._frameStartW = this._frameStartH = 0;\n\t}\n\n\tpointMousedown(e, p) {\n\t\tp.classList.add(\"-active\");\n\n\t\tthis.mode = 2;\n\t\tthis.pageX = this.startX = e.pageX;\n\t\tthis.pageY = this.startY = e.pageY;\n\t\t//[this._imageStartX, this._imageStartY] = [this.imageX, this.imageY];\n\t\t[this._frameStartX, this._frameStartY] = [this.frameX, this.frameY];\n\t\t[this._frameStartW, this._frameStartH] = [this.frameWidth, this.frameHeight];\n\t\tthis.update();\n\t\tthis._debug();\n\t}\n\n\tpointMousemove(e, p) {\n\t\tif (this.mode != 2) return;\n\n\t\tlet [x,y,w,h] = [this._frameStartX, this._frameStartY, this._frameStartW, this._frameStartH];\n\t\tlet [x2,y2] = [x+w, y+h];\n\n\t\t[this.pageX, this.pageY] = [e.pageX, e.pageY];\n\t\tconst dx = (this.pageX - this.startX);// / this.zoom;\n\t\tconst dy = (this.pageY - this.startY);// / this.zoom;\n\t\tlet inversion_x = false;\n\t\tlet inversion_y = false;\n\n\t\tlet n_ = false, s_ = false, e_ = false, w_ = false;\n\t\tif (p.classList.contains(\"-ne\")) {\n\t\t\tn_ = e_ = true;\n\t\t} else if (p.classList.contains(\"-nw\")) {\n\t\t\tn_ = w_ = true;\n\t\t} else if (p.classList.contains(\"-se\")) {\n\t\t\ts_ = e_ = true;\n\t\t} else if (p.classList.contains(\"-sw\")) {\n\t\t\ts_ = w_ = true;\n\t\t}\n\t\tif (n_) y += dy;\n\t\telse if (s_) y2 += dy;\n\n\t\tif (e_) x += dx;\n\t\telse if (w_) x2 += dx;\n\n\t\tif (x > x2) {\n\t\t\tinversion_x = true;\n\t\t\t[x,x2] = [x2,x];\n\t\t}\n\t\tif (y > y2) {\n\t\t\tinversion_y = true;\n\t\t\t[y,y2] = [y2,y];\n\t\t}\n\n\t\tif (x2 - x < 24) x2 = x + 24;\n\t\tif (y2 - y < 24) y2 = y + 24;\n\n\t\tx = Math.min(Math.max(x, this.imageX), this.imageX + this.image.width);\n\t\ty = Math.min(Math.max(y, this.imageY), this.imageY + this.image.height);\n\t\tx2 = Math.min(Math.max(x2, this.imageX), this.imageX + this.image.width);\n\t\ty2 = Math.min(Math.max(y2, this.imageY), this.imageY + this.image.height);\n\n\t\t// adjust ratio\n\t\tif (this.options && this.options.image_size) {\n\t\t\tlet [_w_, _h_] = this.options.image_size;\n\t\t\tif (_w_ > 0 && _h_ > 0) {\n\t\t\t\tconst r_ = _w_ / _h_;\n\t\t\t\tw = x2 - x;\n\t\t\t\th = y2 - y;\n\t\t\t\t_w_ = h * r_;\n\t\t\t\t_h_ = w / r_;\n\t\t\t\tif (w > _w_) {\n\t\t\t\t\tw = _w_;\n\t\t\t\t} else if (h > _h_) {\n\t\t\t\t\th = _h_;\n\t\t\t\t}\n\t\t\t\tif (e_ || (w_ && inversion_x)) x = x2 - w;\n\t\t\t\telse if (w_ || (e_ && inversion_x)) x2 = x + w;\n\n\t\t\t\tif (n_ || (s_ && inversion_y)) y = y2 - h;\n\t\t\t\telse if (s_ || (n_ && inversion_y)) y2 = y + h;\n\n\t\t\t\ty2 = y + h;\n\t\t\t}\n\t\t}\n\n\t\tthis.move(x,y,x2,y2);\n\t\tthis.update();\n\t\tthis._debug();\n\t}\n\tpointMouseup(e, p) {\n\t\tif (this.mode != 2) return;\n\t\tthis.mode = 0;\n\t\tthis.pageX = this.startX = 0;\n\t\tthis.pageY = this.startY = 0;\n\t\tthis._frameStartX = this._frameStartY = 0;\n\t\tthis._frameStartW = this._frameStartH = 0;\n\n\t\tp.classList.remove(\"-active\");\n\t\tthis.framePoints.forEach(p=>p.classList.remove(\"-active\"))\n\t}\n\n\t_debug() {\n\t\tdebug(`\n\t\t\tmode: ${this.mode}<br />\n\t\t\tstart: (${this.startX}, ${this.startY})<br />\n\t\t\tpageX/Y: (${this.pageX}, ${this.pageY})<br />\n\t\t\timage: pos=(${this.imageX}, ${this.imageY}) size=(${this.image.width}, ${this.image.height})<br />\n\t\t\tframe: pos=(${this.frameX}, ${this.frameY}) size=(${this.frameWidth}, ${this.frameHeight})<br />\n\t\t\tzoom: ${this.zoom}\n\t\t`);\n\t}\n}\nexport default Preview;\n","\nconst DATA_DIR = 'data';\nconst CONNECTION_URL = 'http://localhost:8080';\nconst CONNECTION_INTERVAL_T = 2000 * 1000;\nexport {\n\tDATA_DIR,\n\tCONNECTION_URL,\n\tCONNECTION_INTERVAL_T,\n};","\nimport { listen, debug, setStyle, createElement, findByClass } from './util';\nimport { DATA_DIR, CONNECTION_URL, CONNECTION_INTERVAL_T } from './config';\n\n\nlet instance = null;\n\nclass Connection {\n\tconnected:boolean = false;\n\tel: any; \n\n\tconstructor() {\n\t\tthis.mount();\n\t\t// this.showError();\n\t}\n\n\tmount() {\n\t\tthis.el = createElement(\"div\", {\"class\": \"global-error\"}, document.body);\n\t\tthis.el.style.display = \"none\";\n\t}\n\t_observe(callback, error) {\n\t\tlet has_called = false;\n\t\tlet has_errored = false;\n\n\t\tconst self = this;\n\t\tconst done = ()=>{\n\t\t\tsetTimeout(()=>{\n\t\t\t\treq();\n\t\t\t}, CONNECTION_INTERVAL_T);\n\t\t};\n\t\tconst req = ()=>{\n\t\t\tself._connect((...args)=>{\n\t\t\t\tif (has_errored) { \n\t\t\t\t\t// reload when reconnected\n\t\t\t\t\tlocation.reload();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (has_called == false) {\n\t\t\t\t\tcallback.apply(null, args);\n\t\t\t\t\thas_called = true;\n\t\t\t\t}\n\t\t\t\tself.connected = true;\n\t\t\t\tdone();\n\t\t\t}, (err)=> {\n\t\t\t\thas_errored = true;\n\n\t\t\t\tif (error) error(err);\n\t\t\t\tdone();\n\t\t\t});\n\t\t};\n\t\treq();\n\t}\n\t_connect(callback=null, error=null) {\n\t\tif (this._isLocal()) {\n\t\t\tlocation.href = `${CONNECTION_URL}/`;\n\t\t\treturn;\n\t\t}\n\n\t\t//if (this.connected) {\n\t\t//\tif (callback()) callback(true);\n\t\t//\treturn;\n\t\t//}\n\t\tconst self = this;\n\n\t\treturn this._request(\"/status\")\n\t\t\t.then(response=>{\n\t\t\t\tif (callback) callback.call(null, this);\n\t\t\t})\n\t\t\t.catch((err)=>{\n\t\t\t\t// if (callback) callback.call(null, null, err);\n\t\t\t\tif (error) error.call(null, err);\n\n\t\t\t\tself.connected = false;\n\t\t\t\tself.showError();\n\t\t\t});\n\t}\n\t_request(url:string, method:string=\"GET\", data:any=null, complete=null) {\n\t\tlet o = { method }\n\t\tif (method == \"POST\") {\n\t\t\to[\"headers\"] = {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t// 'Content-Type': 'application/x-www-form-urlencoded',\n\t\t\t}\n\t\t\to[\"body\"] = JSON.stringify(data);\n\t\t} \n\t\tconsole.log(url, o);\n\t\tconst p = fetch(this._path(url), o);\n\t\t\n\t\tif (complete) {\n\t\t\tp.then((res)=>{\n\t\t\t\tres.json().then(data=>{\n\t\t\t\t\tcomplete(data);\n\t\t\t\t\treturn data;\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t});\n\t\t}\n\t\t\n\n\t\treturn p;\n\t}\n\t_get(url:string, complete=null) {\n\t\treturn this._request(url, \"GET\", null, complete);\n\t}\n\t_post(url:string, data:any=null, complete=null) {\n\t\treturn this._request(url, \"POST\", data, complete);\n\t}\n\n\n\t_path(url:string) {\n\t\tif (url.indexOf(\"://\") >= 0 || url.indexOf(\"//\") === 0) {\n\t\t\treturn url;\n\t\t}\n\t\tif (url[0] != \"/\") url = `/${url}`;\n\n\t\treturn CONNECTION_URL + url;\n\t}\t\n\t_isLocal() {\n\t\tif (! location || !location.protocol || location.protocol == \"file:\") {\n\t\t\treturn true;\n\t\t}\n\t\tif (location.protocol != \"http:\" && location.protocol != \"https://\") {\n\t\t\treturn true;\n\t\t}\n\t\tif (!location.hostname || `${location.hostname}`.trim() == \"\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tshowError() {\n\t\tif (!this.el) return;\n\n\t\tthis.el.innerHTML = 'Connection failed. Make sure app.py server is runnning. <code>$ python app.py</code>.';\n\t\tthis.el.style.display = \"block\";\t\t\n\t}\n\thideError() {\n\t\tif (!this.el) return;\n\t\t\n\t\tthis.el.style.display = \"none\";\n\t}\n\n\tstatic connect(callback, error=null) {\n\t\tif (! instance) {\n\t\t\tinstance = new Connection();\n\t\t\tinstance._observe(callback, error);\n\t\t} else {\n\t\t\tif (instance.connected) {\n\t\t\t\tif (callback) callback.call(null, instance);\n\t\t\t} else {\n\t\t\t\tinstance._observe(callback, error);\n\t\t\t}\n\t\t}\n\t\treturn instance;\n\t}\n\tstatic isConnected() {\n\t\tif (! instance) {\n\t\t\treturn false;\n\t\t}\n\t\treturn instance.connected;\n\t}\n}\n\nexport default Connection;\n","import { listen, debug, setStyle, createElement, findByClass } from './util';\nimport { DATA_DIR } from './config';\n\nimport Connection from './connection';\n\nclass Sources {\n\toptions = null;\n\n\titems: {\n\t\tname: string, \n\t\tpath_org: string,\n\t\tpath: string, \n\t\ttag: string,\n\t\tdone: boolean,\n\t\tremoved: boolean,\n\n\t\t$li: any, // <li>\n\t\t$image: any, // <img>\n\t\tframe: null, // {x,y,width,height}\n\t}[];\n\n\tel = null; // div.sources\n\tul = null; // <ul>\n\n\tcurrent:number = 0; // item of this.items \n\tmounted:boolean = false;\n\tonchange = null;\n\tonupdate = null;\n\n\tconstructor(items: any[], options=null) {\n\t\tconst self = this;\n\t\tthis.options = options;\n\n\t\tthis.items = [];\n\t\tthis.add(items);\n\t}\n\tadd(items: any[]) {\n\t\tconst self = this;\n\n\t\titems.forEach((item)=>{\n\t\t\tif (typeof item === \"string\") {\n\t\t\t\titem = { \n\t\t\t\t\tname: item,  \n\t\t\t\t\tpath_org: `${DATA_DIR}/${item}`,\n\t\t\t\t\tpath: `${DATA_DIR}/${item}`,\n\t\t\t\t\ttag: null,\n\t\t\t\t\tdone: false,\n\t\t\t\t\tremoved: false,\n\t\t\t\t};\n\t\t\t\titem.$image = new Image();\n\t\t\t\titem.$image.src = item.path;\n\t\t\t}\n\t\t\tself.items.push(item);\n\t\t});\n\n\t\tif (this.mounted) {\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tmount() {\n\t\tif (!(this.el = findByClass(\"sources\"))) {\n\t\t\tthrow '`.sources` not found.';\t\t\t\n\t\t}\n\t\tif (!(this.ul = this.el.querySelector(\"ul\"))) {\n\t\t\t// throw '`.sources > ul` not found.';\t\n\t\t\tthis.ul = createElement(\"ul\", null, this.el);\n\t\t}\n\n\t\tthis.mounted = true;\n\n\t\tthis.update();\n\t\tthis.initEvents();\n\n\t\tthis.change();\n\t}\n\tupdate() {\n\t\tconst self = this;\n\t\tthis.items.forEach((item, index)=>{\n\t\t\t// $li\n\t\t\tlet $li = item.$li = item.$li || createElement(\"li\",null, self.ul);\n\t\t\t//$li.setAttribute(\"title\", item.path);\n\n\t\t\t// $item\n\t\t\tlet $item = findByClass(\"item\", $li) || createElement(\"div\", { \"class\":\"item\" }, $li);\n\t\t\tlet $image = findByClass(\"image\", $item) || createElement(\"div\", {\"class\":\"image\"}, $item, (el)=>{\n\t\t\t\tel.appendChild(item.$image);\n\t\t\t});\n\t\t\tlet $name = findByClass(\"name\", $item) || createElement(\"div\", {\"class\":\"name\"}, $item);\n\t\t\t\n\t\t\t$name.textContent = item.name;\n\n\t\t\tif (self.current == index) {\n\t\t\t\t$item.classList.add(\"-active\");\n\t\t\t} else {\n\t\t\t\t$item.classList.remove(\"-active\");\n\t\t\t}\n\n\t\t\t// click\n\t\t\t//listen.call($li, \"click\", function(e) {\n\t\t\t//\tself.click(e);\n\t\t\t//});\n\n\t\t\t// status\n\t\t\tif (item.done) {\n\t\t\t\t$li.classList.add(\"-ok\");\n\t\t\t\t$li.classList.remove(\"-removed\");\n\t\t\t} else if (item.removed) {\n\t\t\t\t$li.classList.remove(\"-ok\");\n\t\t\t\t$li.classList.add(\"-removed\");\n\t\t\t} else {\n\t\t\t\t$li.classList.remove(\"-ok\");\n\t\t\t\t$li.classList.remove(\"-removed\");\n\t\t\t}\n\t\t});\n\t}\n\t// event\n\tinitEvents() {\n\t\tconst self = this;\n\n\t\tlisten.call(document.body, \"keydown\", (e)=>{\n\t\t\tconst keycode = e.keyCode;\n\t\t\tconst keyname = `${e.key}`.toLowerCase();\n\t\n\t\t\tif ( (keycode == 40 || keyname == 'arrowdown') || \n\t\t\t\t(keycode == 38 || keyname == 'arrowup')) \n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\t\n\t\t\tself.keypress(e);\n\t\t\treturn false;\n\t\t});\n\t\tlisten.call(this.ul, \"click\", function(e){\n\t\t\tself.click(e);\n\t\t})\n\t}\n\tkeypress(e) {\n\t\tconst keycode = e.keyCode;\n\t\tconst keyname = `${e.key}`.toLowerCase();\n\t\t//console.log(keycode, keyname);\n\t\t\n\t\t// down\n\t\tif (keycode == 40 || keyname == 'arrowdown') {\n\t\t\tthis.moveToDown();\n\t\t}\n\t\t// up\n\t\tif (keycode == 38 || keyname == 'arrowup') {\n\t\t\tthis.moveToUp();\n\t\t}\n\t\t// delete\n\t\tif (keycode == 8 || keyname == \"backspace\") {\n\t\t\tthis.remove();\n\t\t}\n\t\t// enter\n\t\tif (keycode == 13 || keyname == 'enter') {\n\t\t\tthis.approve();\n\t\t}\n\t}\n\tclick(e) {\n\t\t// console.log(e);\n\t\tif (! e.path) {\n\t\t\treturn;\n\t\t}\n\t\tconst li = e.path.find(el_=>{\n\t\t\tif (el_.nodeType != Node.ELEMENT_NODE) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn (`${el_.nodeName}`.toLowerCase() == \"li\");\n\t\t});\n\t\t\n\t\tconst index = this.items.findIndex((item)=>{\n\t\t\treturn (item.$li == li);\n\t\t});\n\t\tif (index >= 0) {\n\t\t\tthis.current = index;\n\t\t}\n\n\t\tthis.update();\n\t\tthis.change();\n\t\t//this.scroll();\n\t}\n\tremove() {\n\t\tif (! Connection.isConnected()) {\n\t\t\tthis.moveToDown();\n\t\t\treturn;\n\t\t}\n\t\tif (typeof this.items[this.current] !== \"undefined\") {\n\t\t\tconst current = this.items[this.current];\n\n\t\t\t// already\n\t\t\tif (current.removed) {\n\t\t\t\tthis.update();\n\t\t\t\tthis.moveToDown();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcurrent.done = false;\n\t\t\tcurrent.removed = true;\n\n\t\t\tif (this.onupdate) {\n\t\t\t\tthis.onupdate(current);\n\t\t\t}\n\t\t\tConnection.connect((conn)=>{\n\t\t\t\tconn._request(\"/update\", \"POST\", {\n\t\t\t\t\t\"name\": current.name,\n\t\t\t\t\t\"src\" : current.path, \n\t\t\t\t\t\"action\" : \"remove\",\n\t\t\t\t\t\"frame\" : current.frame || null,\n\t\t\t\t}).then(res=>{\n\t\t\t\t\tres.json().then(data=>{\n\t\t\t\t\t\tif (data.dst) {\n\t\t\t\t\t\t\tcurrent.path = data.dst;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tthis.update();\n\t\tthis.moveToDown();\n\t}\n\tapprove() {\n\t\tif (! Connection.isConnected()) {\n\t\t\tthis.moveToDown();\n\t\t\treturn;\n\t\t}\n\t\tif (typeof this.items[this.current] !== \"undefined\") {\n\t\t\tconst current = this.items[this.current];\n\t\t\t\n\t\t\t// already\n\t\t\tif (current.done) {\n\t\t\t\tthis.update();\n\t\t\t\tthis.moveToDown();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcurrent.done = true;\n\t\t\tcurrent.removed = false;\n\n\t\t\tif (this.onupdate) {\n\t\t\t\tthis.onupdate(current);\n\t\t\t}\n\t\t\tConnection.connect((conn)=>{\n\t\t\t\tconn._request(\"/update\", \"POST\", {\n\t\t\t\t\t\"name\": current.name,\n\t\t\t\t\t\"src\" : current.path, \n\t\t\t\t\t\"action\" : \"ok\",\n\t\t\t\t\t\"frame\" : current.frame || null,\n\t\t\t\t}).then(res=>{\n\t\t\t\t\tres.json().then(data=>{\n\t\t\t\t\t\tif (data.dst) {\n\t\t\t\t\t\t\tcurrent.path = data.dst;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.update();\n\t\tthis.moveToDown();\n\t}\n\tmoveToUp() {\n\t\tif (this.items.length <= 0) {\n\t\t\tthis.current = 0;\n\t\t} else {\n\t\t\t//this.current = (this.current + this.items.length - 1) % this.items.length;\n\t\t\tif (this.current > 0) this.current--;\n\t\t}\n\t\tthis.update();\n\t\tthis.change();\n\t\tthis.scroll();\n\t}\n\tmoveToDown() {\n\t\tif (this.items.length <= 0) {\n\t\t\tthis.current = 0;\n\t\t} else {\n\t\t\t// this.current = (this.current + 1) % this.items.length;\n\t\t\tif (this.current < this.items.length - 1) this.current++;\n\t\t}\n\t\tthis.update();\n\t\tthis.change();\n\t\tthis.scroll();\n\t}\n\tscroll() {\n\t\t//this.el;\n\t\tif (typeof this.items[this.current] !== \"undefined\") {\n\t\t\tlet scrollTop = this.el.scrollTop;\n\t\t\tconst height0 = this.el.clientHeight;\n\t\t\tconst innerHeight = this.el.querySelector(\"ul\").clientHeight;\n\t\t\tif (height0 - 24 > innerHeight) {\n\t\t\t\t//return;\n\t\t\t}\n\n\t\t\tconst current = this.items[this.current];\n\t\t\tconst rect = current.$li.getBoundingClientRect();\n\t\t\tconst top = rect.top;\n\t\t\tconst height = rect.height;\n\n\t\t\tconst top_ = (scrollTop + top) - (height0 - height)/2; // top should be\n\n\t\t\t//if (Math.abs(top - top_) > 24) {\n\t\t\t\tthis.el.scrollTo(0, top_);\n\t\t\t//}\n\t\t}\n\t}\n\n\tchange() {\n\t\tif (typeof this.items[this.current] !== \"undefined\") {\n\t\t\tif (this.onchange) {\n\t\t\t\tthis.onchange.call(this, this.items[this.current]);\n\t\t\t}\n\t\t}\n\t}\n\n}\nexport default Sources;\n","\n\nimport { listen, debug, setStyle } from './util';\nimport Preview from './preview';\nimport Sources from './sources';\nimport Connection from './connection';\n\n// reset events\nconst __return_false = ()=>false;\nlisten(\"wheel\", __return_false);\n//listen(\"click\", __return_false);\n//listen(\"mousedown\", __return_false);\n//listen(\"mousemove\", __return_false);\n//listen(\"mouseup\", __return_false);\n\n// connect\nConnection.connect((conn)=>{\n\tif (! conn) return;\n\n\tlet options = null;\n\n\t// config\n\tconn._get(\"/config\", data=>{\n\t\toptions = data.options;\n\n\t\t// list\n\t\tconn._get(\"/list\",data=>{\n\t\t\tlet preview = null;\n\t\n\t\t\tconst s = new Sources(data[\"sources\"], options);\n\t\t\ts.onchange = function(item) {\n\t\t\t\t// remount preview\n\t\t\t\tif (preview) {\n\t\t\t\t\tpreview.free();\n\t\t\t\t\tpreview = null;\n\t\t\t\t}\n\t\t\t\tpreview = new Preview(item, options);\n\t\t\t\tpreview.mount();\n\t\t\t};\n\t\t\ts.onupdate = function(item) {\n\t\t\t\t// item.removed\n\t\t\t\t// item.done\n\t\t\t};\n\t\t\ts.mount();\n\t\t});\n\t});\n});\n\n"],"names":["listen","name","callback","this","window","addEventListener","_debug","setAttrs","el","attrs","text","Object","keys","forEach","k","v","k_","style","Array","isArray","v_","classList","add","remove","split","trim","textContent","setStyle","styles","createElement","tagName","parentNode","document","appendChild","findByClass","q","elements","getElementsByClassName","length","image_data","options","data","imageUrl","path","reset","Preview","mode","startX","startY","pageX","pageY","imageX","imageY","_imageStartX","_imageStartY","_frameStartX","_frameStartY","_frameStartW","_frameStartH","frameX","frameY","frameWidth","frameHeight","zoom","self","framePoints","p","__point_mousedown","removeEventListener","__point_mousemove","frame","__point_mouseup","frameDragger","frameImage","bg","__mousedown","__mousemove","__mouseup","image","Image","src","complete","onload","self_1","onerror","err","class","dir","push","w0","clientWidth","h0","clientHeight","width","height","x","y","image_size","_a","_w_","_h_","r_","_b","w_1","h_1","update","initEvents","left","top","transform","e","dragMousedown","dragMousemove","dragMouseup","call","pointMousedown","pointMousemove","pointMouseup","x2","y2","tmp","Math","max","min","console","log","_d","w","h","_e","dx","dy","_c","move","inversion_x","inversion_y","n_","s_","e_","w_","contains","_f","s","body","innerHTML","DATA_DIR","CONNECTION_URL","instance","mount","Connection","display","error","has_called","has_errored","done","setTimeout","req","_connect","_i","args","location","reload","apply","connected","_isLocal","_request","then","response","_this","showError","href","url","method","o","JSON","stringify","fetch","_path","res","json","indexOf","protocol","hostname","_observe","items","Sources","item","path_org","tag","removed","$image","mounted","ul","querySelector","change","index","$li","$item","current","keycode","keyCode","keyname","key","toLowerCase","preventDefault","stopPropagation","keypress","click","moveToDown","moveToUp","approve","li","find","el_","nodeType","Node","ELEMENT_NODE","nodeName","findIndex","isConnected","current_1","onupdate","connect","conn","action","dst","current_2","scroll","scrollTop","height0","rect","getBoundingClientRect","top_","scrollTo","onchange","_get","preview","free"],"mappings":"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"}